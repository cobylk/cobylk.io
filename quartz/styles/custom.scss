@use "./base.scss";

// put your custom CSS here!

// Add CSS variables for colors with RGB values for the glowing effect
:root {
  // Updated colors with purple scheme
  --purple-primary: #6a4c93; // Deep purple
  --purple-secondary: #8675a9; // Medium purple
  --purple-tertiary: #c3b1e1; // Light purple
  --purple-highlight: #42275a; // Dark purple
  
  // RGB versions for gradient effects
  --purple-primary-rgb: 106, 76, 147;
  --purple-secondary-rgb: 134, 117, 169;
  --purple-tertiary-rgb: 195, 177, 225;
  
  // Override the Quartz theme colors with our purple scheme
  --secondary: var(--purple-primary) !important;
  --tertiary: var(--purple-secondary) !important;
  --highlight: rgba(var(--purple-tertiary-rgb), 0.15) !important;
  
  // Original colors kept for reference
  --secondary-rgb: var(--purple-primary-rgb); /* #6a4c93 replaced #284b63 */
  --tertiary-rgb: var(--purple-secondary-rgb); /* #8675a9 replaced #84a59d */
}

// Page title hover effect
.page-title a {
  position: relative;
  text-decoration: none;
  border: 1px solid var(--purple-primary);
  padding: 0.5rem 1.5rem;
  overflow: hidden;
  transition: box-shadow 0.3s ease, transform 0.3s ease, font-size 0.3s ease;
  display: inline-block;
  white-space: nowrap; // Prevent wrapping
  
  &:hover {
    box-shadow: 1px 1px 25px 10px rgba(var(--purple-primary-rgb), 0.4);
  }
  
  &:before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      120deg,
      transparent,
      rgba(var(--purple-primary-rgb), 0.4),
      transparent
    );
    transition: all 650ms;
    z-index: 1;
  }
  
  &:hover:before {
    left: 100%;
  }
  
  // Responsive scaling for smaller screens
  @media (max-width: 768px) {
    font-size: 0.85em;
    padding: 0.4rem 1.2rem;
  }
  
  @media (max-width: 480px) {
    font-size: 0.75em;
    padding: 0.3rem 1rem;
  }
}

// Hide specific elements based on CSS classes
.hide-title .article-title {
  display: none !important;
}

.hide-meta .content-meta {
  display: none !important;
}

// Hide title and metadata on the index page
body[data-slug="index"] {
  .article-title, 
  .content-meta {
    display: none !important;
  }
}

// Responsive image container for side-by-side images
.image-container {
  margin: 2rem 0;
  
  img {
    object-fit: contain;
    height: auto;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    border-radius: 4px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    
    &:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }
  }
  
  // Adjust layout for smaller screens
  @media (max-width: 768px) {
    flex-direction: column;
    
    img {
      max-width: 100% !important;
      margin-bottom: 1rem;
    }
  }
}

// Explorer list with connected dots and cursor highlight effect
.explorer-content {
  // Base styling
  position: relative;
  overflow: visible !important; // Change from hidden to prevent scrollbar
  
  // Custom light effect for hover
  &::before {
    content: "";
    position: absolute;
    width: 12rem; // Much larger
    height: 12rem; // Much larger
    border-radius: 50%;
    background: radial-gradient(circle, 
      rgba(var(--purple-tertiary-rgb), 0.1) 0%, // Less opaque
      rgba(var(--purple-tertiary-rgb), 0.06) 40%, // Less opaque
      rgba(var(--purple-tertiary-rgb), 0.03) 60%, // Added middle layer
      transparent 80%); // Wider fade
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.8s ease; // Slower fade transition
    z-index: 0;
    transform: translate(-50%, -50%);
    filter: blur(8px); // Add blur for softer edges
  }
  
  // Hover effect for the main container
  &:hover::before {
    opacity: 1;
  }
  
  // Each list in the explorer
  ul {
    position: relative;
    list-style: none;
    margin: 0;
    padding: 0;
    
    // Create the line connections
    li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.05rem; // Reduced gap between items
      
      // The vertical connecting line
      &::before {
        content: "";
        position: absolute;
        left: 0.425rem; // Adjusted to center with larger dot
        top: 0;
        height: calc(100% + 0.05rem); // Extend line to connect with next item
        width: 1.5px; // Thicker line
        background-color: rgba(var(--purple-primary-rgb), 0.3);
        z-index: 1;
      }
      
      // The dot
      &::after {
        content: "";
        position: absolute;
        left: 0.25rem;
        top: 0.6rem;
        height: 0.45rem; // Bigger dot (1.5x)
        width: 0.45rem; // Bigger dot (1.5x)
        border-radius: 50%;
        background-color: var(--purple-primary);
        z-index: 2;
        transition: background-color 0.2s ease, transform 0.2s ease;
        cursor: pointer; // Show pointer cursor on dots
      }
      
      // Remove the vertical line for the last item
      &:last-child::before {
        height: 0.65rem; // Just enough to reach the dot center
      }
      
      // Fix: Prevent extra dot below the last item by ensuring
      // no generated content for pseudo-elements on .folder-outer:empty
      .folder-outer:empty::before,
      .folder-outer:empty::after {
        display: none;
      }
      
      // Hover effect for the dots and links
      &:hover::after {
        background-color: var(--purple-secondary);
        transform: scale(1.5);
      }
      
      // When hovering over a list item, move the glow effect to that location
      &:hover {
        ~ .explorer-content::before {
          opacity: 1;
        }
      }
      
      // Make the cursor effect follow each item when hovered
      @for $i from 1 through 10 {
        &:nth-child(#{$i}):hover ~ .explorer-content::before {
          left: 1rem;
          top: calc(#{$i} * 1.5rem - 0.5rem);
        }
      }
    }
  }
  
  // Special styling for folder items
  .folder-outer > ul {
    border-left: none !important; // Remove default border
    padding-left: 0.5rem; // Adjust padding
  }
  
  // Folder button styling
  .folder-container {
    margin-left: 0 !important; // Override the default margin
    padding-left: 0 !important;
  }
  
  // Adjust the button inside folder containers to align with file links
  .folder-container div {
    margin-left: 0;
    padding-left: 0;
  }
  
  // Make folder buttons align perfectly with file links
  .folder-container div button.folder-button {
    padding-left: 0;
    margin-left: 0;
  }
  
  // Give file links and folder titles the same indentation
  .explorer-content ul li > a,
  .explorer-content .folder-container div button span.folder-title {
    margin-left: 0;
    padding-left: 0;
  }
  
  // Make file links more interactive
  ul li > a {
    position: relative;
    z-index: 3;
    transition: color 0.2s ease;
    color: var(--dark) !important;
    
    &:hover {
      color: var(--purple-secondary) !important;
    }
    
    &.active {
      color: var(--purple-primary) !important;
      font-weight: 600;
    }
  }
  
  // Fix: Target all the potential causes of extra dots
  div:empty::before,
  div:empty::after,
  ul:empty::before,
  ul:empty::after,
  .folder-outer:empty::before,
  .folder-outer:empty::after,
  .content:empty::before,
  .content:empty::after {
    display: none !important;
  }
  
  // Fix dots that appear in nested folder structures
  li:not(:has(> a)):not(:has(.folder-container))::after {
    display: none !important;
  }
  
  // Fix connecting lines in nested structures
  li:not(:has(> a)):not(:has(.folder-container))::before {
    display: none !important;
  }
  
  // Fix the line heights for the last items in nested lists
  ul li:last-child {
    &::before {
      height: 0.65rem !important;
    }
  }
}

// Fix for persistent extra dots
.explorer-content .folder-outer {
  position: relative;
  
  // If this is an empty folder, don't show any pseudo-elements 
  &:empty::before, &:empty::after {
    display: none !important;
  }
}

// Fix for the last item in any nested folder
.explorer-content ul li:last-child .folder-outer::before {
  height: auto !important;
  bottom: 0.65rem;
}

// Alternative approach with event listeners via custom properties
// This will be added to the page's CSS and doesn't require JavaScript
html {
  --mouse-x: 0;
  --mouse-y: 0;
}

// Add a custom interactive cursor highlight using a wrapper div
.sidebar.left {
  position: relative;
  
  &:hover .explorer::after {
    content: "";
    position: fixed;
    width: 16rem; // Much larger size
    height: 16rem; // Much larger size
    border-radius: 50%;
    background: radial-gradient(circle, 
      rgba(var(--purple-tertiary-rgb), 0.12) 0%, // Less opaque
      rgba(var(--purple-tertiary-rgb), 0.08) 30%, // Less opaque
      rgba(var(--purple-tertiary-rgb), 0.05) 60%, // Added middle layer
      transparent 85%); // Wider fade
    pointer-events: none;
    z-index: 10;
    transform: translate(-50%, -50%);
    left: var(--mouse-x, 0);
    top: var(--mouse-y, 0);
    transition: 
      left 0.05s ease, 
      top 0.05s ease,
      opacity 0.8s ease; // Slower fade for smoother transition
    opacity: 0; // Start transparent
    filter: blur(10px); // Add blur effect for softer edges
  }
  
  // Add fade-in effect when hovering on the sidebar
  &:hover .explorer::after {
    opacity: 1; // Fade in when hovering
  }
}

// Make dots clickable by adding wrapper over the dots
.explorer-content ul li::after {
  pointer-events: auto; // Make the dot clickable
}

// Remove any scrollbars caused by our fixes
.explorer-content {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;     /* Firefox */
  
  // Remove scrollbar for WebKit browsers (Chrome, Safari)
  &::-webkit-scrollbar {
    display: none;
  }
}

// Hide the chevron/arrow in front of folder names
.folder-container svg.folder-icon {
  display: none !important;
}

// Minimal CSS for Feather icons
.social-icons {
  display: flex;
  gap: 0.8rem; // Reduced from 1rem
  margin: 1rem 0;
  
  a {
    color: var(--purple-primary);
    transition: color 0.2s ease;
    display: flex; // Ensure icon is centered within its container
    align-items: center; // Center vertically
    justify-content: center; // Center horizontally
    
    &:hover {
      color: var(--purple-secondary);
    }
    
    svg {
      width: 1.2rem;
      height: 1.2rem;
      stroke-width: 2;
    }
  }
}

// Tooltip styles
.tooltip {
  display: inline;
  position: relative;
  /* Extremely tight padding */
  padding: 0.03rem 0.06rem;
  background: rgba(var(--purple-tertiary-rgb), 0.15);
  border: 1px solid rgba(var(--purple-primary-rgb), 0.2);
  border-radius: 3px;
  line-height: 1.1;
  cursor: var(--tooltip-cursor, help);

  // Set cursor from data attribute
  &[data-cursor] {
    --tooltip-cursor: attr(data-cursor);
  }

  // Links should use pointer cursor
  &[href] {
    cursor: pointer;
  }

  &::after {
    content: attr(data-number);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    vertical-align: super;
    margin-left: 0.15rem;
    color: var(--purple-primary);
  }

  @media (max-width: 768px) {
    cursor: pointer;
    
    &.active {
      background: rgba(var(--purple-tertiary-rgb), 0.25);
      border-color: rgba(var(--purple-primary-rgb), 0.3);
    }
  }
}

.tooltip-text {
  position: fixed;
  display: none;
  padding: 0.5rem 1rem;
  background: var(--dark);
  color: var(--light);
  border: 1px solid rgba(var(--purple-primary-rgb), 0.3);
  border-radius: 4px;
  font-size: 0.875rem;
  max-width: 300px;
  z-index: 1000;
  pointer-events: none;
  line-height: 1.4;

  &.visible {
    display: block;
  }

  @media (prefers-color-scheme: dark) {
    background: var(--light);
    color: var(--dark);
  }

  @media (max-width: 768px) {
    position: absolute;
    width: fit-content;
    min-width: 25px;
    max-width: min(300px, 90vw);
    box-sizing: border-box;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    transform: translateX(-50%);
    left: auto;
    margin-top: 0.5rem;
  }
}
